{
	"name": "Policies",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "CosmosDBPolicies2",
						"type": "DatasetReference"
					},
					"name": "Policies"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "CosmosDBPolicies2",
						"type": "DatasetReference"
					},
					"name": "OdsPolicies"
				}
			],
			"transformations": [
				{
					"name": "AddSourceFlag"
				},
				{
					"name": "Select1"
				}
			],
			"script": "source(output(\n\t\tCountryName as string,\n\t\tCountryCode as string,\n\t\tRegionName as string,\n\t\tRegionCode as string,\n\t\tJurisdiction as string,\n\t\tDate as string,\n\t\t{C1_School closing} as integer,\n\t\tC1_Flag as integer,\n\t\t{C2_Workplace closing} as integer,\n\t\tC2_Flag as integer,\n\t\t{C3_Cancel public events} as integer,\n\t\tC3_Flag as integer,\n\t\t{C4_Restrictions on gatherings} as integer,\n\t\tC4_Flag as integer,\n\t\t{C5_Close public transport} as integer,\n\t\tC5_Flag as integer,\n\t\t{C6_Stay at home requirements} as integer,\n\t\tC6_Flag as integer,\n\t\t{C7_Restrictions on internal movement} as integer,\n\t\tC7_Flag as integer,\n\t\t{C8_International travel controls} as integer,\n\t\t{E1_Income support} as string,\n\t\tE1_Flag as string,\n\t\t{E2_Debt contract relief} as string,\n\t\t{E3_Fiscal measures} as string,\n\t\t{E4_International support} as string,\n\t\t{H1_Public information campaigns} as string,\n\t\tH1_Flag as string,\n\t\t{H2_Testing policy} as string,\n\t\t{H3_Contact tracing} as string,\n\t\t{H4_Emergency investment in healthcare} as string,\n\t\t{H5_Investment in vaccines} as string,\n\t\t{H6_Facial Coverings} as string,\n\t\tH6_Flag as string,\n\t\t{H7_Vaccination policy} as string,\n\t\tH7_Flag as string,\n\t\t{H8_Protection of elderly people} as string,\n\t\tH8_Flag as string,\n\t\tM1_Wildcard as string,\n\t\tStringencyIndex as double,\n\t\tStringencyIndexForDisplay as double,\n\t\tStringencyLegacyIndex as double,\n\t\tStringencyLegacyIndexForDisplay as double,\n\t\tGovernmentResponseIndex as double,\n\t\tGovernmentResponseIndexForDisplay as double,\n\t\tContainmentHealthIndex as double,\n\t\tContainmentHealthIndexForDisplay as double,\n\t\tEconomicSupportIndex as double,\n\t\tEconomicSupportIndexForDisplay as double,\n\t\tid as string,\n\t\t{_rid} as string,\n\t\t{_self} as string,\n\t\t{_etag} as string,\n\t\t{_attachments} as string,\n\t\t{_ts} as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> Policies\nPolicies derive(SourceFlag = \"CosmosDB\") ~> AddSourceFlag\nAddSourceFlag select(mapColumn(\n\t\tCountryCode,\n\t\tRegionName,\n\t\tRegionCode,\n\t\tJurisdiction,\n\t\tDate,\n\t\tC1_Schoolclosing = {C1_School closing},\n\t\tC1_Flag,\n\t\tC2_Workplaceclosing = {C2_Workplace closing},\n\t\tC2_Flag,\n\t\t{C3_Cancel publicevents} = {C3_Cancel public events},\n\t\tC3_Flag,\n\t\tC4_Restrictionsongatherings = {C4_Restrictions on gatherings},\n\t\tC4_Flag,\n\t\t{C5_Close publictransport} = {C5_Close public transport},\n\t\tC5_Flag,\n\t\t{C6_Stay at homerequirements} = {C6_Stay at home requirements},\n\t\tC6_Flag,\n\t\tC7_Restrictionsoninternalmovement = {C7_Restrictions on internal movement},\n\t\tC7_Flag,\n\t\tC8_Internationaltravelcontrols = {C8_International travel controls},\n\t\tE1_Incomesupport = {E1_Income support},\n\t\tE1_Flag,\n\t\t{E2_Debt contractrelief} = {E2_Debt contract relief},\n\t\t{E3_Fiscal measures},\n\t\tE4_Internationalsupport = {E4_International support},\n\t\tH1_Publicinformationcampaigns = {H1_Public information campaigns},\n\t\tH1_Flag,\n\t\tH2_Testingpolicy = {H2_Testing policy},\n\t\tH3_Contacttracing = {H3_Contact tracing},\n\t\tH4_Emergencyinvestmentinhealthcare = {H4_Emergency investment in healthcare},\n\t\tH5_Investmentinvaccines = {H5_Investment in vaccines},\n\t\tH6_FacialCoverings = {H6_Facial Coverings},\n\t\tH6_Flag,\n\t\tH7_Vaccinationpolicy = {H7_Vaccination policy},\n\t\tH7_Flag,\n\t\tH8_Protectionofelderlypeople = {H8_Protection of elderly people},\n\t\tH8_Flag,\n\t\tM1_Wildcard,\n\t\tStringencyIndex,\n\t\tStringencyIndexForDisplay,\n\t\tStringencyLegacyIndex,\n\t\tStringencyLegacyIndexForDisplay,\n\t\tGovernmentResponseIndex,\n\t\tGovernmentResponseIndexForDisplay,\n\t\tContainmentHealthIndex,\n\t\tContainmentHealthIndexForDisplay,\n\t\tEconomicSupportIndex,\n\t\tEconomicSupportIndexForDisplay,\n\t\tid,\n\t\tSourceFlag\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select1\nSelect1 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\tCountryName as string,\n\t\tCountryCode as string,\n\t\tRegionName as string,\n\t\tRegionCode as string,\n\t\tJurisdiction as string,\n\t\tDate as string,\n\t\t{C1_School closing} as string,\n\t\tC1_Flag as string,\n\t\t{C2_Workplace closing} as string,\n\t\tC2_Flag as string,\n\t\t{C3_Cancel public events} as string,\n\t\tC3_Flag as string,\n\t\t{C4_Restrictions on gatherings} as string,\n\t\tC4_Flag as string,\n\t\t{C5_Close public transport} as string,\n\t\tC5_Flag as string,\n\t\t{C6_Stay at home requirements} as string,\n\t\tC6_Flag as string,\n\t\t{C7_Restrictions on internal movement} as string,\n\t\tC7_Flag as string,\n\t\t{C8_International travel controls} as string,\n\t\t{E1_Income support} as string,\n\t\tE1_Flag as string,\n\t\t{E2_Debt contract relief} as string,\n\t\t{E3_Fiscal measures} as string,\n\t\t{E4_International support} as string,\n\t\t{H1_Public information campaigns} as string,\n\t\tH1_Flag as string,\n\t\t{H2_Testing policy} as string,\n\t\t{H3_Contact tracing} as string,\n\t\t{H4_Emergency investment in healthcare} as string,\n\t\t{H5_Investment in vaccines} as string,\n\t\t{H6_Facial Coverings} as string,\n\t\tH6_Flag as string,\n\t\t{H7_Vaccination policy} as string,\n\t\tH7_Flag as string,\n\t\t{H8_Protection of elderly people} as string,\n\t\tH8_Flag as string,\n\t\tM1_Wildcard as string,\n\t\tStringencyIndex as string,\n\t\tStringencyIndexForDisplay as string,\n\t\tStringencyLegacyIndex as string,\n\t\tStringencyLegacyIndexForDisplay as string,\n\t\tGovernmentResponseIndex as string,\n\t\tGovernmentResponseIndexForDisplay as string,\n\t\tContainmentHealthIndex as string,\n\t\tContainmentHealthIndexForDisplay as string,\n\t\tEconomicSupportIndex as string,\n\t\tEconomicSupportIndexForDisplay as string,\n\t\tid as string,\n\t\t{_rid} as string,\n\t\t{_self} as string,\n\t\t{_etag} as string,\n\t\t{_attachments} as string,\n\t\t{_ts} as string\n\t),\n\tpartitionFileNames:['Policies.csv'],\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tmapColumn(\n\t\tCountryName = CountryCode,\n\t\tCountryCode,\n\t\tRegionName,\n\t\tRegionCode,\n\t\tJurisdiction,\n\t\tDate,\n\t\t{C1_School closing} = C1_Schoolclosing,\n\t\tC1_Flag,\n\t\t{C2_Workplace closing} = C2_Workplaceclosing,\n\t\tC2_Flag,\n\t\t{C3_Cancel public events} = {C3_Cancel publicevents},\n\t\tC3_Flag,\n\t\t{C4_Restrictions on gatherings} = C4_Restrictionsongatherings,\n\t\tC4_Flag,\n\t\t{C5_Close public transport} = {C5_Close publictransport},\n\t\tC5_Flag,\n\t\t{C6_Stay at home requirements} = {C6_Stay at homerequirements},\n\t\tC6_Flag,\n\t\t{C7_Restrictions on internal movement} = C7_Restrictionsoninternalmovement,\n\t\tC7_Flag,\n\t\t{C8_International travel controls} = C8_Internationaltravelcontrols,\n\t\t{E1_Income support} = E1_Incomesupport,\n\t\tE1_Flag,\n\t\t{E2_Debt contract relief} = {E2_Debt contractrelief},\n\t\t{E3_Fiscal measures},\n\t\t{E4_International support} = E4_Internationalsupport,\n\t\t{H1_Public information campaigns} = H1_Publicinformationcampaigns,\n\t\tH1_Flag,\n\t\t{H2_Testing policy} = H2_Testingpolicy,\n\t\t{H3_Contact tracing} = H3_Contacttracing,\n\t\t{H4_Emergency investment in healthcare} = H4_Emergencyinvestmentinhealthcare,\n\t\t{H5_Investment in vaccines} = H5_Investmentinvaccines,\n\t\t{H6_Facial Coverings} = H6_FacialCoverings,\n\t\tH6_Flag,\n\t\t{H7_Vaccination policy} = H7_Vaccinationpolicy,\n\t\tH7_Flag,\n\t\t{H8_Protection of elderly people} = H8_Protectionofelderlypeople,\n\t\tH8_Flag,\n\t\tM1_Wildcard,\n\t\tStringencyIndex,\n\t\tStringencyIndexForDisplay,\n\t\tStringencyLegacyIndex,\n\t\tStringencyLegacyIndexForDisplay,\n\t\tGovernmentResponseIndex,\n\t\tGovernmentResponseIndexForDisplay,\n\t\tContainmentHealthIndex,\n\t\tContainmentHealthIndexForDisplay,\n\t\tEconomicSupportIndex,\n\t\tEconomicSupportIndexForDisplay,\n\t\tid\n\t),\n\tpartitionBy('hash', 1)) ~> OdsPolicies"
		}
	}
}